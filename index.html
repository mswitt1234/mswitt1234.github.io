<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Call Flow Analyzer</title>
</head>
<body>
  <h1>Upload Call Flow Folder</h1>
  <input type="file" id="folderInput" webkitdirectory multiple />
  <button onclick="processFiles()">Process Files</button>

  <script>
    async function processFiles() {
      const input = document.getElementById('folderInput');
      const files = Array.from(input.files);

      const callflowFiles = files.filter(file =>
        file.name.endsWith('.callflow') || file.name.endsWith('.workflow')
      );

      if (callflowFiles.length === 0) {
        alert('No .callflow or .workflow files found.');
        return;
      }

      const sizeData = [];
      const dependencyData = [];

      for (const file of callflowFiles) {
        const text = await file.text();
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(text, "application/xml");

        // Placeholder: log root element
        console.log(`Parsed ${file.name}:`, xmlDoc.documentElement.nodeName);

        // TODO: Add logic to extract sizing and dependency data
        // sizeData.push(...);
        // dependencyData.push(...);
      }

      // TODO: Convert sizeData and dependencyData to CSV and trigger download
      console.log("Ready to generate CSVs");
    }
  </script>
</body>
</html>
